import{h as D,r,j as e,G as n,M as F,i as M,b as g,w as m,F as v,a as B,d as A,T as p,t as O}from"./index-8vjFNNnn.js";const $=async o=>{try{const s=JSON.parse(sessionStorage.getItem("user")),a=(s==null?void 0:s.accessToken)||"",c=await fetch("https://executivetracking.cloudjiffy.net/MahaasabhaMember/request/v1/createRequest",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(o)});if(!c.ok)throw new Error("Request failed");return await c.json()}catch(s){return console.error(s),null}},z=async(o,s)=>{try{const a=JSON.parse(sessionStorage.getItem("user")),c=(a==null?void 0:a.accessToken)||"",l=await fetch(`https://executivetracking.cloudjiffy.net/Mahaasabha/request/v1/getAllRequestByPagination/{pageNumber}/{pageSize}?pageNumber=${o}&pageSize=${s}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`}});if(!l.ok)throw new Error("Failed to fetch requests");return await l.json()}catch(a){return console.error(a),{content:[],totalElements:0}}},W=async o=>{try{const s=JSON.parse(sessionStorage.getItem("user")),a=(s==null?void 0:s.accessToken)||"";if(!(await fetch(`https://executivetracking.cloudjiffy.net/MahaasabhaMember/request/v1/deleteRequestById/${o}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}})).ok)throw new Error("Failed to delete request");return!0}catch(s){return console.error(s),!1}},V=()=>{D();const[o,s]=r.useState(!1),[a,c]=r.useState(""),[l,T]=r.useState(""),[y,R]=r.useState(1),[S,J]=r.useState(1),[j,q]=r.useState([]),[u,f]=r.useState(0),[d,w]=r.useState(9),[C,b]=r.useState(0);r.useEffect(()=>{x(u,d)},[u,d]);const k=()=>{s(!o)},E=async()=>{await $({description:a,requestName:l,mahaasabhaMemberDto:{memberId:S},requestTypeDto:{requestTypeId:y}})?(alert("Request raised successfully!"),x(u,d)):alert("Failed to raise request.")},P=async t=>{window.confirm("Are you sure you want to delete this request?")&&(await W(t)?(alert("Request deleted successfully!"),x(u,d)):alert("Failed to delete request."))},x=async(t,i)=>{const h=await z(t,i);h&&h.content?(q(h.content),b(h.totalElements)):(q([]),b(0))},I=(t,i)=>{f(i)},N=t=>{w(parseInt(t.target.value,10)),f(0)};return e.jsxs(n,{children:[e.jsx(F,{title:"Request",children:e.jsxs(n,{container:!0,spacing:M,children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(g,{variant:"contained",color:"primary",fullWidth:!0,onClick:k,children:o?"Hide Form":"Raise Request"})}),o&&e.jsxs(e.Fragment,{children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(m,{label:"Request Title",variant:"outlined",fullWidth:!0,value:l,onChange:t=>T(t.target.value),placeholder:"Enter request name here"})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(m,{label:"Description",variant:"outlined",fullWidth:!0,value:a,onChange:t=>c(t.target.value),placeholder:"Enter description here"})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(m,{select:!0,label:"Select Request Type",variant:"outlined",fullWidth:!0,value:y,onChange:t=>R(t.target.value),children:[e.jsx(v,{value:1,children:"Info"}),e.jsx(v,{value:2,children:"Other"})]})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(g,{variant:"contained",color:"primary",fullWidth:!0,onClick:E,children:"Submit"})})]})]})}),e.jsx("br",{}),e.jsx(n,{container:!0,spacing:2,children:j.length>0?j.map(t=>{var i;return e.jsx(n,{item:!0,xs:12,sm:6,md:4,children:e.jsx(B,{variant:"outlined",style:{height:"100%",padding:"16px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",borderRadius:"8px"},children:e.jsxs(A,{children:[e.jsx(p,{variant:"h6",gutterBottom:!0,children:t.requestName}),e.jsx(p,{variant:"body2",color:"textSecondary",children:t.description}),e.jsxs(p,{variant:"body2",style:{marginTop:"8px"},children:[e.jsx("strong",{children:"Request Type:"})," ",((i=t.requestTypeDto)==null?void 0:i.requestTypeName)||"N/A"]}),e.jsxs(p,{variant:"body2",style:{marginTop:"4px"},children:[e.jsx("strong",{children:"Status:"})," ",t.status]}),e.jsx(g,{variant:"outlined",color:"secondary",style:{marginTop:"12px"},onClick:()=>P(t.requestId),children:"Delete"})]})})},t.requestId)}):e.jsx(n,{item:!0,xs:12,children:e.jsx(p,{align:"center",variant:"body2",color:"textSecondary",children:"No requests available"})})}),e.jsx(O,{component:"div",count:C,page:u,onPageChange:I,rowsPerPage:d,onRowsPerPageChange:N})]})};export{V as default};
